---
title: "Stressor Interactions at the Community Level - Empirical Data"
author: "James Orr"
output:
   html_notebook:
     code_folding: hide
     theme: flatly
     toc: true
     toc_depth: 4
     number_sections: no
---

### Intro 

Here I use databases created by Dr. Michelle Jackson and colleagues to compare how different community metrics observe stressor interactions. I filter through the databases to find cases where multiple community metrics (biomass, decomposition, diversity) were  used to quantify the interactive effects of the same stressors on the same community in the same experiment. 

Then I plot the hedges d values of one group of community metrics (e.g. biomass) against the hedges d values of another group of community metrics (e.g. diversity).

There are two databases that I use:

1. **Morris et al. 2022**: This contains interactions between temperature + another stressor in freshwater experiments up to 2019. There are 296 observations.

2. **Jackson et al. 2016 (no warming)**: This contains interactions between pairs of stressors in freshwater experiments up to 2014. To prevent any overlap between the two databases all observations in Jackson et al. 2016 that include temperature were already removed. There are 165 observations. 

<br>

*Set up*

```{r, results="hide"}
# R version 4.1.3 (June 2022)

rm(list = ls())               # clear the environment 

# Packages
library(tidyverse)            # Organising and manipulating data

# Colours 
j_blue <- rgb(80/255, 112/255, 245/255)
j_red <- rgb(220/255, 70/255, 50/255)
j_yellow <- rgb(225/255, 180/255, 60/255)
j_grey <- rgb(0.6, 0.6, 0.6)
```

*Load data*

```{r}
jackson_2021 <- read.csv("data/jackson_2021_full.csv", 
                     header = TRUE)

jackson_2016 <- read.csv("data/jackson_2016_notemp.csv", 
                     header = TRUE)

length(unique(jackson_2016$Study))
length(unique(jackson_2021$Study))
```

There are 125 (54 + 71) studies in the database.

*Subset the relevant data*

```{r}
# Select the relevant columns and filter to get community level responses 

###### Jackson et al 2021 #######
jackson_2021 <- jackson_2021 %>%
   select(c(Study, ID, Year, FirstAuthor,
            StressorOne, StressorTwo, OrganisationLevel,
            ResponseVariable, Responsefurther, ResponseDefined,
            HedgesdAdditive, VdAdditive)) %>%
   filter(OrganisationLevel == "Community")

###### Jackson et al 2016 #######
# also need to create a unique observation ID column 
jackson_2016 <- jackson_2016 %>%
  mutate(ID = seq.int(nrow(jackson_2016))) %>%
  select(-c(Code, Journal, Location, Organism, Experiment, stressor_pair)) %>%
  filter(Response == "Community")

```

*Obtain hedges d and 95% CI and match the datasets*

Code taken from Morris et al. 2022 

```{r}
# Calculate the confidence interval for hedges g based on standard deviation
# Create variable to classify stressor interactions based on hedges d only
# Create variable to classify stressor interactions based on hedges d + 95% CI

# 95CI: 1.96
# 90CI: 1.645
# 80CI: 1.282

######################## Jackson et al 2021 ###########################
jackson_2021 <- jackson_2021 %>%
  mutate(CI = (1.96*(sqrt(VdAdditive)))) %>%
  mutate(int = ifelse(HedgesdAdditive < 0, 
                      "ant", ifelse(HedgesdAdditive > 0,
                                    "syn", "within"))) %>%
  mutate(INT = ifelse(HedgesdAdditive + CI < 0, 
                      "ANT", ifelse(HedgesdAdditive - CI > 0,
                                    "SYN", "WITHIN"))) %>%
  mutate(study_code = paste(FirstAuthor, Year, sep = "_"))


######################## Jackson et al 2016######################## 
jackson_2016 <- jackson_2016 %>%
  
  ### Add columns to data to calculate hedges d effect sizes
  # standard deviation of null expectation
  mutate(Sd_p = sqrt((((S1_n-1)*(S1_sd)^2)+((S2_n)-1)*(S2_sd)^2)/
                       (S1_n+S2_n-2))) %>%
  # n_p of null expectation
  mutate(n_p = pmin(S1_n,S2_n)) %>%
  # j - weighting factor based on replicates
  mutate(j = (1-(3/(4*(S1_S2_n+(n_p)-2)-1)))) %>%
  # s - pooled standard deviation of predicted and combined responses
  mutate(s = sqrt((((S1_S2_n-1)*(S1_S2_sd)^2) +((n_p)-1)*(Sd_p)^2 )/
                    (S1_S2_n+(n_p)-2))) %>%
  
  ### Calculate hedges d 
  mutate(HedgesdAdditive = ((S1_S2_mean-Additive)/s)*j) %>%
  #Invert the hedges d if null model is negative
  mutate(HedgesdAdditive = ifelse(Additive < 0, -HedgesdAdditive, 
                                  HedgesdAdditive)) %>%
  
  ### Calculate variance around hedges
  mutate(VdAdditive = ((S1_S2_n+(n_p))/(S1_S2_n*(n_p))) + 
           (((HedgesdAdditive)^2)/(2*(S1_S2_n+(n_p))))) %>%
  
  ### Calculate CI, set interaction types, create study code and clean up
  mutate(CI = (1.96*(sqrt(VdAdditive)))) %>%
  mutate(int = ifelse(HedgesdAdditive < 0, 
                      "ant", ifelse(HedgesdAdditive > 0,
                                    "syn", "within"))) %>%
  mutate(INT = ifelse(HedgesdAdditive + CI < 0, 
                      "ANT", ifelse(HedgesdAdditive - CI > 0,
                                    "SYN", "WITHIN"))) %>%
  mutate(study_code = paste(Author, Year, sep = "_")) %>%
  select(-c(S1_mean, S1_sd, S1_n, S2_mean, S2_sd, S2_n, S1_S2_mean, S1_S2_sd,
            S1_S2_n, C_mean, C_sd, C_n, Sd_p, n_p, j, s, Additive, Dominance,
            Predicted.additive.effect.based.on.Thompson.paper...only.relevent.for.population.level.responses,
            Predicted_additive_effect._multiplicative_risk)) %>%
  rename(OrganisationLevel = Response) %>%
  rename(ResponseVariable = Response.1) %>%
  rename(ResponseDefined = Variable) %>%
  rename(FirstAuthor = Author) %>%
  rename(StressorOne = S1) %>%
  rename(StressorTwo = S2) 

# Correct the spelling of decomposition in the 2016 database
jackson_2016$ResponseVariable <- gsub("Decompostion", "Decomposition",
                                      jackson_2016$ResponseVariable)


length(unique(jackson_2016$Study))
length(unique(jackson_2021$Study))

```

There are 59 (33 + 26) studies that look at stressor interactions at the community level. 

<br>

At the community level we now have 263 (161 + 102) observations. Response variables at the community level have been classified into different groups: 

```{r, echo=FALSE}

knitr::kable(table(jackson_2021$Responsefurther), 
             caption = "Jackson et al 2021 (n=158)")
knitr::kable(table(jackson_2016$ResponseVariable), 
             caption = "Jackson et al 2016 (n=102)")
```


Biomass is the most commonly studied type of response variable at the community level. Abundance is very common as well but it is usually used instead of biomass so there are few (if any) cases where these two functions are recorded at once. Diversity and decomposition are also both measured quite often. It would be nice to compare biomass with diversity and biomass with decomposition. 

I need to identify pairs of observations from the same experiment, for the same combination of stressors and for the same taxonomic group (e.g. it isn't fair to plot diversity of rotifers against biomass of plants). 

<br>

### Biomass and Diversity

*Subset observations of biomass or diversity *

```{r, results = "hide"}
###### Jackson et al 2021 #######
bio_div <- jackson_2021 %>%
  filter(Responsefurther %in% c("Biomass", "Diversity", "Abundance")) %>%
  mutate(Responsefurther = ifelse(Responsefurther == "Diversity",
                                  "Diversity", "Biomass"))
  
###### Jackson et al 2016 #######
bio_div2 <- jackson_2016 %>%
  filter(ResponseVariable %in% c("Animal biomass/abundance", 
                                  "Diversity Animal",
                                  "Diversity Plant", 
                                  "other biomass/abundance",
                                  "Plant biomass/abundance")) %>%
  mutate(Responsefurther = ifelse(ResponseVariable %in% c("Diversity Animal",
                                                          "Diversity Plant"),
                                  "Diversity", "Biomass"))
```

*Function to put pairs of observations together one row*

```{r}
# A function taking pairs of observation IDs 
# The first observation will be X axis and the second will by Y axis
# data is the dataframe where you filter from 
# The output is a single row for that pair 

group.pair <- function(X, Y, data){
   pair <- data %>%
      filter(ID == X | ID == Y) %>%
      pivot_wider(names_from = Responsefurther,
                  values_from = c(Study, ID, Year, FirstAuthor, 
                                  StressorOne, StressorTwo, ResponseVariable,
                                  Responsefurther, ResponseDefined,
                                  HedgesdAdditive, VdAdditive, 
                                  CI, int, INT)) %>%
      mutate(ID_pair = interaction(X, Y))
   return(pair)
}
```

*Manually identify relevant pairs*

```{r}
###### Jackson et al 2021 #######
## Biomass, Diversity 
Kratina <- group.pair(11, 13, bio_div)
Piggott2012a <- group.pair(32, 34, bio_div)
Piggott2012b <- group.pair(33, 35, bio_div)
Thompson <- group.pair(69, 70, bio_div)
Sorfa <- group.pair(134, 137, bio_div)
Sorfb <- group.pair(132, 136, bio_div)
MacLennana <- group.pair(183, 182, bio_div)
MacLennanab <- group.pair(184, 181, bio_div)
Piggott2015a <- group.pair(214, 218, bio_div)
Piggott2015b <- group.pair(215, 219, bio_div)
Piggott2015c <- group.pair(214, 222, bio_div)
Piggott2015d <- group.pair(215, 223, bio_div)

###### Jackson et al 2016 #######
## Biomass, Diversity 
Rotter <- group.pair(17, 16, bio_div2)
Piggott2012c <- group.pair(118, 113, bio_div2)
Liess <- group.pair(156, 155, bio_div2)
Molinosb <- group.pair(117, 112, bio_div2) 

```

*Create dataframe for plotting*

```{r}
# combine into a dataframe
hedges_biodiv <- bind_rows(list(
  Kratina, Piggott2012a, Piggott2012b, Thompson, Sorfa, Sorfb, MacLennana, 
  MacLennanab, Piggott2015a, Piggott2015b, Piggott2015c, Piggott2015d, Rotter, 
  Piggott2012c, Liess, Molinosb))
  
# create a label (from 1 to n) and rename variables
# create variable to identify quadrant the points are in and set color variable
# take CI into account for QUANDRANT and COLOUR variables
hedges_biodiv <- hedges_biodiv %>%
  mutate(label = seq.int(nrow(hedges_biodiv))) %>%
  rename(HedgesdAdditive_X = HedgesdAdditive_Biomass) %>%
  rename(HedgesdAdditive_Y = HedgesdAdditive_Diversity) %>%
  rename(CI_X = CI_Biomass) %>%
  rename(CI_Y = CI_Diversity) %>%
  rename(int_X = int_Biomass) %>%
  rename(int_Y = int_Diversity) %>%
  rename(INT_X = INT_Biomass) %>%
  rename(INT_Y = INT_Diversity) %>%
  mutate(quad = ifelse(int_X == "ant" & int_Y == "ant", "ANTS",
                           ifelse(int_X == "syn" & int_Y == "syn", "SYNS",
                                  ifelse(int_X == "within" & int_Y == "within",
                                         "ADDS", "MISMATCH")))) %>%
  mutate(colour = ifelse(quad == "ADDS", j_grey,
                         ifelse(quad == "ANTS", j_blue,
                                ifelse(quad == "SYNS", j_yellow, j_red)))) %>%
  mutate(QUAD = ifelse(INT_X == "ANT" & INT_Y == "ANT", "ANTS",
                           ifelse(INT_X == "SYN" & INT_Y == "SYN", "SYNS",
                                  ifelse(INT_X == "WITHIN" & INT_Y == "WITHIN",
                                         "ADDS", "MISMATCH")))) %>%
  mutate(COLOUR = ifelse(QUAD == "ADDS", j_grey,
                         ifelse(QUAD == "ANTS", j_blue,
                                ifelse(QUAD == "SYNS", j_yellow, j_red))))

# cleaning environment
rm(Kratina, Piggott2012a, Piggott2012b, Thompson, Sorfa, Sorfb, MacLennana, 
  MacLennanab, Piggott2015a,Piggott2015b, Piggott2015c, Piggott2015d, Rotter,
  Piggott2012c, Liess, Molinosb)

### Set plant, animal and "other" as factors to change point shape 
hedges_biodiv$ResponseVariable_Biomass <- 
  as.factor(hedges_biodiv$ResponseVariable_Biomass)

```

<br>

### Biomass and Decomposition 

*Filter data to select responses measuring function* 

```{r}
bio_dec <- jackson_2021 %>%
  filter(Responsefurther %in% c("Biomass", "Decomposition",
                                 "Abundance")) %>%
  mutate(Responsefurther = ifelse(ResponseVariable == "Decomposition",
                                  "Decomposition", "Biomass"))   
  
bio_dec2 <- jackson_2016 %>%
  filter(ResponseVariable %in% c("Animal biomass/abundance", 
                                 "other biomass/abundance",
                                 "Plant biomass/abundance",
                                 "Decomposition")) %>%
  mutate(Responsefurther = ifelse(ResponseVariable == "Decomposition",
                                  "Decomposition", "Biomass"))    

```

*Manually identify relevant pairs*

```{r}
###### Jackson et al 2021 #######
Piggott2012c <- group.pair(32, 38, bio_dec)
Piggott2012d <- group.pair(33, 39, bio_dec)
Thompsonb <- group.pair(67, 68, bio_dec)
Piggott2015e <- group.pair(214, 158, bio_dec)
Piggott2015f <- group.pair(215, 159, bio_dec)
Thompsona <- group.pair(69, 68, bio_dec)  

###### Jackson et al 2016 #######
# not enough details for Jackson 2014 (invasion x invasions)
Matthaeia <- group.pair(85, 82, bio_dec2)
Matthaeib <- group.pair(114, 101, bio_dec2)
Matthaeic <- group.pair(115, 100, bio_dec2)
Piggott2012e <- group.pair(118, 102, bio_dec2) 
Funck <- group.pair(64, 61, bio_dec2)
Fernandes <- group.pair(65, 62, bio_dec2)
```

*Create dataframe for plotting*

```{r}
hedges_biodecomp <- bind_rows(list(
  Piggott2012c, Piggott2012d, Thompsona, Thompsonb, Piggott2015e, Piggott2015f,
  Matthaeia, Matthaeib, Matthaeic, Piggott2012e, Funck, Fernandes))

hedges_biodecomp <- hedges_biodecomp %>%
  mutate(label = seq.int(nrow(hedges_biodecomp))) %>%
  rename(HedgesdAdditive_X = HedgesdAdditive_Biomass) %>%
  rename(HedgesdAdditive_Y = HedgesdAdditive_Decomposition) %>%
  rename(CI_X = CI_Biomass) %>%
  rename(CI_Y = CI_Decomposition) %>%
  rename(int_X = int_Biomass) %>%
  rename(int_Y = int_Decomposition) %>%
  rename(INT_X = INT_Biomass) %>%
  rename(INT_Y = INT_Decomposition) %>%
  mutate(quad = ifelse(int_X == "ant" & int_Y == "ant", "ANTS",
                           ifelse(int_X == "syn" & int_Y == "syn", "SYNS",
                                  ifelse(int_X == "within" & int_Y == "within",
                                         "ADDS", "MISMATCH")))) %>%
  mutate(colour = ifelse(quad == "ADDS", j_grey,
                         ifelse(quad == "ANTS", j_blue,
                                ifelse(quad == "SYNS", j_yellow, j_red)))) %>%
  mutate(QUAD = ifelse(INT_X == "ANT" & INT_Y == "ANT", "ANTS",
                           ifelse(INT_X == "SYN" & INT_Y == "SYN", "SYNS",
                                  ifelse(INT_X == "WITHIN" & INT_Y == "WITHIN",
                                         "ADDS", "MISMATCH")))) %>%
  mutate(COLOUR = ifelse(QUAD == "ADDS", j_grey,
                         ifelse(QUAD == "ANTS", j_blue,
                                ifelse(QUAD == "SYNS", j_yellow, j_red))))

rm(Piggott2012c, Piggott2012d, Thompsona, Thompsonb, Piggott2015e, Piggott2015f,
   Matthaeia, Matthaeib, Matthaeic, Piggott2012e, Funck, Fernandes)

### Set plant, animal and "other" as factors to change point shape 
hedges_biodecomp$ResponseVariable_Biomass <- 
  as.factor(hedges_biodecomp$ResponseVariable_Biomass)


```

<br>
<br>
<br>

### Figures 

*Main figure* 

```{r, echo=FALSE, fig.width=10, fig.height=5, include=TRUE, results = "hide"}


par(mfrow = c(1, 2))

##################### Biomass v Diversity  ##################### 

# set data
hedges = hedges_biodiv

### List of points for the next plot
#levels(hedges_biodiv$ResponseVariable_Biomass)
points <- c(17, 19)   # animals, plants

####### Set plot ######### 
par(mar=c(6, 6, 2, 2)) # bottom, left, top, right
plot(1, type="n", xlab="", ylab="", bty="o", las = 1,
     xlim=c(-3, 3), ylim=c(-3, 3))
abline(h = 0, lty = 2, col = rgb(0, 0, 0, 0.5), lwd = 2.5)
abline(v = 0, lty = 2, col = rgb(0, 0, 0, 0.5), lwd = 2.5)

####### Points ####### 
points(hedges$HedgesdAdditive_X, hedges$HedgesdAdditive_Y,
       pch = points[hedges_biodiv$ResponseVariable_Biomass], 
       cex = 4, bg = rgb(0.35, 0.5, 1, 1), 
       col = hedges$colour)

####### Labels ####### 
text(hedges$HedgesdAdditive_X, hedges$HedgesdAdditive_Y,
     labels = hedges$label, col = "white", font = 2, cex = 1)

###### Axes and Legend ###### 
mtext("Hedges d - Biomass", 1, line = 4, cex = 1.3, font = 2)
mtext("Hedges d - Diversity", 2, line = 4, cex = 1.3, font = 2)
legend("topright", legend = paste(hedges$label, hedges$study_code, 
                                  sep = ": "), cex = 1)

legend("topleft", legend=c("Animals", "Plants"), 
       pch = points, cex=1.4, col = rgb(0.6, 0.6, 0.6))  


##################### Biomass v Diversity  ##################### 

# set data
hedges = hedges_biodecomp

### List of points for the next plot
# levels(hedges_biodecomp$ResponseVariable_Biomass)
points <- c(17, 15, 19) # animal, other, plants

####### Set plot ######### 
par(mar=c(6, 6, 2, 2)) # bottom, left, top, right
plot(1, type="n", xlab="", ylab="", bty="o", las = 1,
     xlim=c(-4.5, 4.5), ylim=c(-4.5, 4.5))
abline(h = 0, lty = 2, col = rgb(0, 0, 0, 0.5), lwd = 2.5)
abline(v = 0, lty = 2, col = rgb(0, 0, 0, 0.5), lwd = 2.5)

####### Points ####### 
points(hedges$HedgesdAdditive_X, hedges$HedgesdAdditive_Y,
       pch = points[hedges$ResponseVariable_Biomass], 
       cex = 4, bg = rgb(0.35, 0.5, 1, 1), 
       col = hedges$colour)

####### Labels ####### 
text(hedges$HedgesdAdditive_X, hedges$HedgesdAdditive_Y,
     labels = hedges$label, col = "white", font = 2, cex = 1)

###### Axes and Legend ###### 
mtext("Hedges d - Biomass", 1, line = 4, cex = 1.3, font = 2)
mtext("Hedges d - Decomposition", 2, line = 4, cex = 1.3, font = 2)
legend("topright", legend = paste(hedges$label, hedges$study_code, 
                                  sep = ": "), cex = 1)

legend("topleft", legend=c("Animals", "Fungi", "Plants"), 
       pch = points, cex=1.4, col = rgb(0.6, 0.6, 0.6))  


rm(hedges)
```

The non-additivity observed by biomass and by diversity is not correlated. Only 25% (4/16) of the pairs of observations report the same type of non-additivity. The four pairs of observations that did qualitatively match were all measuring the effects of stressors on plant communities. 

The non-additivity observed by biomass and by decomposition is also poorly correlated. Here 50% (6/12) of the pairs of observations report the same type of non-additivity. There is no obvious pattern between different types of commjunities. 

<br>
<br>


*Supplemental figure* 

```{r, echo=FALSE, fig.width=10, fig.height=5, include=TRUE, results = "hide"}

par(mfrow = c(1, 2))

##################### Biomass v Diversity  ##################### 

# set data
hedges = hedges_biodiv

### List of points for the next plot
#levels(hedges_biodiv$ResponseVariable_Biomass)
points <- c(17, 19)   # animals, plants

####### Set plot ######### 
par(mar=c(6, 6, 2, 2)) # bottom, left, top, right
plot(1, type="n", xlab="", ylab="", bty="o", las = 1,
     xlim=c(-4.5, 4.5), ylim=c(-4.5, 4.5))
abline(h = 0, lty = 2, col = rgb(0, 0, 0, 0.5), lwd = 2.5)
abline(v = 0, lty = 2, col = rgb(0, 0, 0, 0.5), lwd = 2.5)

####### Arrows ####### 
arrows( x0 = hedges$HedgesdAdditive_X, 
        x1 = hedges$HedgesdAdditive_X, 
        y0 = hedges$HedgesdAdditive_Y - hedges$CI_Y, 
        y1 = hedges$HedgesdAdditive_Y + hedges$CI_Y,
        col = hedges$COLOUR, code = 3, length = 0.07, angle = 90, lwd = 2)
arrows( x0 = hedges$HedgesdAdditive_X - hedges$CI_X, 
        x1 = hedges$HedgesdAdditive_X + hedges$CI_X, 
        y0 = hedges$HedgesdAdditive_Y, 
        y1 = hedges$HedgesdAdditive_Y,
        col = hedges$COLOUR, code = 3, length = 0.07, angle = 90, lwd = 2)

####### Points ####### 
points(hedges$HedgesdAdditive_X, hedges$HedgesdAdditive_Y,
       pch = points[hedges_biodiv$ResponseVariable_Biomass], 
       cex = 4, bg = rgb(0.35, 0.5, 1, 1), 
       col = hedges$COLOUR)

####### Labels ####### 
text(hedges$HedgesdAdditive_X, hedges$HedgesdAdditive_Y,
     labels = hedges$label, col = "white", font = 2, cex = 1)

###### Axes and Legend ###### 
mtext("Hedges d - Biomass", 1, line = 4, cex = 1.3, font = 2)
mtext("Hedges d - Diversity", 2, line = 4, cex = 1.3, font = 2)
legend("topright", legend = paste(hedges$label, hedges$study_code, 
                                  sep = ": "), cex = 0.8)

legend("topleft", legend=c("Animals", "Plants"), 
       pch = points, cex=1.4, col = rgb(0.6, 0.6, 0.6))  


##################### Biomass v Diversity  ##################### 

# set data
hedges = hedges_biodecomp

### List of points for the next plot
# levels(hedges_biodecomp$ResponseVariable_Biomass)
points <- c(17, 15, 19) # animal, other, plants

####### Set plot ######### 
par(mar=c(6, 6, 2, 2)) # bottom, left, top, right
plot(1, type="n", xlab="", ylab="", bty="o", las = 1,
     xlim=c(-6, 6), ylim=c(-6, 6))
abline(h = 0, lty = 2, col = rgb(0, 0, 0, 0.5), lwd = 2.5)
abline(v = 0, lty = 2, col = rgb(0, 0, 0, 0.5), lwd = 2.5)

arrows( x0 = hedges$HedgesdAdditive_X, 
        x1 = hedges$HedgesdAdditive_X, 
        y0 = hedges$HedgesdAdditive_Y - hedges$CI_Y, 
        y1 = hedges$HedgesdAdditive_Y + hedges$CI_Y,
        col = hedges$COLOUR, code = 3, length = 0.07, angle = 90, lwd = 2)
arrows( x0 = hedges$HedgesdAdditive_X - hedges$CI_X, 
        x1 = hedges$HedgesdAdditive_X + hedges$CI_X, 
        y0 = hedges$HedgesdAdditive_Y, 
        y1 = hedges$HedgesdAdditive_Y,
        col = hedges$COLOUR, code = 3, length = 0.07, angle = 90, lwd = 2)

####### Points ####### 
points(hedges$HedgesdAdditive_X, hedges$HedgesdAdditive_Y,
       pch = points[hedges$ResponseVariable_Biomass], 
       cex = 4, bg = rgb(0.35, 0.5, 1, 1), 
       col = hedges$COLOUR)

####### Labels ####### 
text(hedges$HedgesdAdditive_X, hedges$HedgesdAdditive_Y,
     labels = hedges$label, col = "white", font = 2, cex = 1)

###### Axes and Legend ###### 
mtext("Hedges d - Biomass/Abundance", 1, line = 4, cex = 1.3, font = 2)
mtext("Hedges d - Decomposition", 2, line = 4, cex = 1.3, font = 2)
legend("topright", legend = paste(hedges$label, hedges$study_code, 
                                  sep = ": "), cex = 0.8)

legend("topleft", legend=c("Animals", "Fungi", "Plants"), 
       pch = points, cex=1.4, col = rgb(0.6, 0.6, 0.6))  


rm(hedges)
```

Using the 95% confidence intervals of hedges d to statistically define stressor interactions shows that most studies did not have the statistical power (sample size) to detect antagonism or synergism. When studies did detect stressor interactions there was always a qualitative mismatch between biomass and diversity. Biomass and decomposition only detected the same stressor interaction once.

<br>

### Table for SM and data for plotting

*Re-organise data and write csv files*
```{r}

################## Biomass v Diversity ##################
hedges_biodiv_sm <- hedges_biodiv %>%
  select(c(label, study_code, StressorOne_Diversity, 
           StressorTwo_Diversity,
           ResponseDefined_Biomass, ResponseDefined_Diversity, 
           HedgesdAdditive_X, HedgesdAdditive_Y, CI_Y, CI_X, quad)) %>%
  rename(StressorOne = StressorOne_Diversity,
         StressorTwo = StressorTwo_Diversity, 
         BiomassVariable = ResponseDefined_Biomass,
         DiversityVariable = ResponseDefined_Diversity)


################## Biomass v Decomposition ##################
hedges_biodecomp_sm <- hedges_biodecomp %>%
  select(c(label, study_code, StressorOne_Decomposition, 
           StressorTwo_Decomposition,
           ResponseDefined_Biomass, ResponseDefined_Decomposition, 
           HedgesdAdditive_X, HedgesdAdditive_Y, CI_Y, CI_X, quad)) %>%
  rename(StressorOne = StressorOne_Decomposition,
         StressorTwo = StressorTwo_Decomposition, 
         BiomassVariable = ResponseDefined_Biomass,
         DecompositionVariable = ResponseDefined_Decomposition)

#write_csv(hedges_biodiv_sm, "data/output/biomass_diversity.csv")
#write_csv(hedges_biodecomp_sm, "data/output/biomass_decomposition.csv")

rm(hedges_biodecomp_sm, hedges_biodiv_sm)
```

<br>
<br>